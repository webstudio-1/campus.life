"use strict";(self.modernJsonp=self.modernJsonp||[]).push([[47442],{792862:(e,n,a)=>{a.r(n),a.d(n,{default:()=>I});var t=a(667294),o=a(545007),l=a(20256),i=a(985459),r=a(547504),s=a(95460),d=a(119343),c=a(233846),u=a(298568);function p({constraint:e}){let n=(0,u.A)(),a=n?.getId();return(0,t.useEffect)(()=>{n&&n.markConstraintComplete(e)},[a,e]),null}var _=a(349057),m=a(181710),v=a(943369),h=a(677316),b=a(755090),w=a(961238),f=a(356204),y=a(739951),k=a(506536),P=a(757653),S=a(785893);let g=(0,P.Z)(()=>a.e(43473).then(a.bind(a,16736)),void 0,e=>16736,"PinSaveButtonCommon"),x=(0,t.lazy)(async()=>({default:(await Promise.all([a.e(69965),a.e(50714),a.e(22538)]).then(a.bind(a,797043))).QuickSaveButtonWithExperienceAnchor})),I=({boardCount:e=0,clientTrackingParams:n,onBoardSelectionFlyoutChange:a,onClickCallback:P,pin:I,showEnabledSaveBehavior:T,showRepinOnInitialRender:A,variant:C,viewParameter:Z,viewType:B,saveToBoardFromPostDownloadUpsell:E,setSaveToBoardFromPostDownloadUpsell:j})=>{let D=(0,u.A)(),{experience:q}=(0,d.Ow)(1000310),{experience:F}=(0,d.Ow)(12),M=(0,h.Z)(),Q=(0,o.I0)(),U=(0,c.ZP)(),R=(0,t.useRef)(!1),{pins:K,clear:N}=(0,f.Z)(),O=(0,v.M0)().getItem(r.M8)||"",J=O?O===I.id:!!K&&K.length>0&&K[K.length-1].id===I.id;(0,b.Z)(()=>{R.current||2!==K.length&&(1!==K.length||J)||(R.current=!0,(2===K.length&&!O&&J?[K[0]]:K).forEach(({id:e,nodeId:n})=>{(0,i.Z)({description:"",entityId:e,link:"",promotedIsRemovable:void 0,title:""},U).then(a=>{let{id:t,url:o,name:l}=a;Q((0,y.d)({boardId:t,url:o,title:l||"",pinId:e||"",nodeId:n}))})}),J||N())});let W=()=>{(0,v.M0)().removeItem(r.M8),N(),M({action:"trigger",item:"unauth-save-button-quicksave"}),Q((0,k.Z)(!0)),Q((0,y.d)({boardId:"",url:"",title:"Profile",pinId:I.id,nodeId:I?.node_id})),Q((0,y.X)(I))},z=()=>{(0,_.Nx)("button"),D&&D.markConstraintComplete("button")};if(I?.pinner?.blocked_by_me||I?.promoted_is_removable)return(0,_.Nx)("button"),(0,S.jsx)(p,{constraint:"button"});if(q&&502450===q.experience_id)return(0,S.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_QuickSaveButton",children:(0,S.jsx)(m.Z,{children:(0,S.jsx)(x,{autoQuicksaveCallback:W,clientTrackingParams:n,experience:q,onClickCallback:P,onMount:z,pinKey:{type:"deprecated",data:I},saveToBoardFromPostDownloadUpsell:E,setSaveToBoardFromPostDownloadUpsell:j,shouldAutoQuicksave:J,showEnabledSaveBehavior:T,viewParameter:Z})})});let H=!I.content_sensitivity?.is_sensitive_content&&void 0!==e,V=[501041],X=F&&501041===F.experience_id&&F.display_data.has_tooltip?e=>(0,S.jsx)(d.Qp,{anchor:e,experienceIds:V,idealDirection:"down",placementId:12,positionRelativeToAnchor:!0,showCaret:!0}):e=>(0,S.jsx)(d.N,{anchors:{3010:e},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0});return H?(0,S.jsx)(l.xu,{children:(0,S.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_PinBetterSave",children:(0,S.jsx)(w.default,{autoQuicksaveCallback:W,clientTrackingParams:n,onClickCallback:P,onMount:z,onToggleFlyout:a,pinKey:{type:"deprecated",data:I},renderPinSaveTooltip:X,saveToBoardFromPostDownloadUpsell:E,setSaveToBoardFromPostDownloadUpsell:j,shouldAutoQuicksave:J,variant:C,viewParameter:Z,viewType:B})})}):(0,S.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_PinSaveButton",children:(0,S.jsx)(m.Z,{children:(0,S.jsx)(g,{clientTrackingParams:n,isCloseupPin:!0,onClickCallback:P,onMount:z,pinKey:{type:"deprecated",data:I},renderPinSaveTooltip:X,saveToBoardFromPostDownloadUpsell:E,setSaveToBoardFromPostDownloadUpsell:j,showRepinOnInitialRender:A})})})}},356204:(e,n,a)=>{a.d(n,{$:()=>s,Z:()=>c});var t=a(547504),o=a(838380),l=a(967312),i=a(943369),r=a(756493);let s=2,d=e=>e.length?{pins:e}:null,c=()=>{let e,n=(0,i.M0)(),a=(e=n.accessAllowed?n.getItem(t.s1):r.ZP.getItem(o.w3),e?.pins??[]),c=e=>n.accessAllowed?n.setItem(t.s1,d(e)):r.ZP.setItem(o.w3,d(e)),u=s,{checkExperiment:p}=(0,l.FJ)(),_=()=>{let e=p("mweb_block_unauth_save").group;if(e.startsWith("enabled")){let[,n]=e.split("_");u=Number(n)}let n=p("mweb_q2_mau_push_pc").anyEnabled,t=p("mweb_q2_mau_push_pc_advanced").anyEnabled,o=p("mweb_q2_mau_push_pc_advanced_row").anyEnabled,l=p("mweb_q2_mau_push_pc_emergency").anyEnabled,i=p("mweb_q2_mau_push_pc_emergency_row").anyEnabled,r=p("mweb_q2_mau_push_pc_eu").anyEnabled,s=p("mweb_q2_mau_push_pc_eu_safe").anyEnabled;return(n||t||o||l||i||r||s)&&(u=0),a.length<u};return{pins:a,save:e=>{_()&&c(a.filter(({id:n})=>n!==e.id).concat([e]))},unsave:e=>c(a.filter(({id:n})=>n!==e)),isSaved:e=>a.some(({id:n})=>n===e),clear:()=>c([]),canSaveMore:_}}},506536:(e,n,a)=>{a.d(n,{Z:()=>t});function t(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/SaveAffordance-07b56a01353b254e.mjs.map